<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>商談キット｜単価・数量・自動化で回収を設計</title>
  <meta name="description" content="顧問料差額の回収は3つ（単価・数量・自動化）。まず売上換算で物差しを揃え、次の一手を数値で決める商談用キット。" />
  <style>
    :root{
      --brand:#578899;
      --bg:#0b0f12;
      --card:#11181d;
      --card2:#0f151a;
      --text:#e9f1f6;
      --muted:#9fb2c1;
      --line:rgba(255,255,255,.10);
      --ok:#4bd37b;
      --warn:#ffcc66;
      --bad:#ff6b6b;
      --shadow:0 14px 40px rgba(0,0,0,.35);
      --r:16px;
    }
    *{box-sizing:border-box}
    body{
      margin:0; background:linear-gradient(180deg, var(--bg), #070a0c 60%);
      color:var(--text);
      font-family: system-ui, -apple-system, "Hiragino Sans", "Noto Sans JP", "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      line-height:1.45;
    }
    a{color:inherit}
    .wrap{max-width:980px; margin:0 auto; padding:18px 14px 44px}
    .top{
      position:sticky; top:0; z-index:9;
      backdrop-filter:saturate(1.2) blur(10px);
      background:rgba(11,15,18,.72);
      border-bottom:1px solid var(--line);
    }
    .topin{max-width:980px; margin:0 auto; padding:10px 14px; display:flex; gap:12px; align-items:center; justify-content:space-between}
    .badge{
      display:inline-flex; align-items:center; gap:10px;
      padding:10px 12px; border:1px solid var(--line); border-radius:999px;
      background:rgba(255,255,255,.04);
    }
    .dot{width:10px; height:10px; border-radius:50%; background:var(--brand); box-shadow:0 0 0 6px rgba(87,136,153,.15)}
    .ttl{font-weight:800}
    .sub{color:var(--muted); font-size:12px}
    .btn{
      appearance:none; border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      color:var(--text); border-radius:12px;
      padding:10px 12px; font-weight:700; cursor:pointer;
      transition:.15s transform,.15s background,.15s border-color;
    }
    .btn:hover{transform:translateY(-1px); background:rgba(255,255,255,.07); border-color:rgba(255,255,255,.18)}
    .btn.primary{background:rgba(87,136,153,.22); border-color:rgba(87,136,153,.45)}
    .btn.primary:hover{background:rgba(87,136,153,.30)}
    .btn.ghost{background:transparent}
    .grid{display:grid; gap:12px}
    .card{
      background:linear-gradient(180deg, var(--card), var(--card2));
      border:1px solid var(--line);
      border-radius:var(--r);
      padding:14px;
      box-shadow:var(--shadow);
    }
    h2{margin:0 0 10px; font-size:18px}
    h3{margin:0 0 8px; font-size:16px}
    .p{color:var(--muted); margin:6px 0 0}
    .row{display:grid; grid-template-columns:1fr 1fr; gap:10px}
    @media (max-width:760px){ .row{grid-template-columns:1fr} }
    label{display:block; font-size:12px; color:var(--muted); margin:0 0 6px}
    input{
      width:100%; padding:12px 12px;
      border-radius:12px; border:1px solid rgba(255,255,255,.12);
      background:rgba(0,0,0,.25); color:var(--text);
      font-size:16px; outline:none;
    }
    input:focus{border-color:rgba(87,136,153,.65); box-shadow:0 0 0 4px rgba(87,136,153,.18)}
    .help{font-size:12px; color:var(--muted); margin-top:6px}
    .kpi{
      display:grid; grid-template-columns:1fr 1fr 1fr; gap:10px; margin-top:10px;
    }
    @media (max-width:760px){ .kpi{grid-template-columns:1fr} }
    .k{
      border:1px solid rgba(255,255,255,.10);
      border-radius:14px;
      padding:12px;
      background:rgba(255,255,255,.03);
    }
    .k .t{font-size:12px; color:var(--muted)}
    .k .v{font-size:18px; font-weight:900; margin-top:6px}
    .chips{display:flex; flex-wrap:wrap; gap:8px; margin-top:10px}
    .chip{
      padding:8px 10px; border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.03);
      color:var(--muted); font-size:12px;
    }
    .routes{display:grid; grid-template-columns:1fr 1fr 1fr; gap:12px; margin-top:10px}
    @media (max-width:860px){ .routes{grid-template-columns:1fr} }
    .routeBtn{
      text-align:left;
      padding:14px; border-radius:16px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.04);
      cursor:pointer;
      transition:.15s transform,.15s background,.15s border-color;
    }
    .routeBtn:hover{transform:translateY(-1px); background:rgba(255,255,255,.06); border-color:rgba(255,255,255,.18)}
    .routeBtn .name{font-weight:900; font-size:16px}
    .routeBtn .desc{color:var(--muted); font-size:12px; margin-top:6px}
    .routeBtn .tag{margin-top:10px; display:inline-flex; font-size:12px; font-weight:800; padding:6px 10px; border-radius:999px; background:rgba(87,136,153,.18); border:1px solid rgba(87,136,153,.35)}
    details{border-top:1px solid var(--line); margin-top:12px; padding-top:12px}
    summary{cursor:pointer; font-weight:900}
    .actions{display:flex; flex-wrap:wrap; gap:8px; margin-top:10px}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
    .foot{margin-top:14px; color:var(--muted); font-size:12px}
    .warnbox{
      border:1px solid rgba(255,204,102,.35);
      background:rgba(255,204,102,.08);
      border-radius:14px;
      padding:12px;
      margin-top:10px;
    }
  </style>
</head>

<body>
  <div class="top">
    <div class="topin">
      <div class="badge">
        <span class="dot"></span>
        <div>
          <div class="ttl">商談キット</div>
          <div class="sub">単価・数量・自動化で「差額回収」をその場で設計</div>
        </div>
      </div>
      <div style="display:flex; gap:8px; align-items:center;">
        <button class="btn ghost" id="btnCopySummary">結果をコピー</button>
        <button class="btn primary" id="btnOpenSalesTool">売上換算ツールを開く</button>
      </div>
    </div>
  </div>

  <div class="wrap">
    <div class="grid">
      <!-- 0) 物差し -->
      <section class="card" id="section-scale">
        <h2>まず：物差しを揃える（売上換算）</h2>
        <div class="p">「でもお高いんでしょう」を、投資判断に変換します。差額を <b>限界利益率</b> で割り戻し、必要な売上に直します。</div>

        <div class="row" style="margin-top:12px;">
          <div>
            <label for="feeDiff">顧問料の差額（円 / 月）</label>
            <input id="feeDiff" inputmode="numeric" placeholder="例：20000" />
            <div class="help">月額差額を入力（例：+2万円）。</div>
          </div>
          <div>
            <label for="cmr">御社の限界利益率（%）</label>
            <input id="cmr" inputmode="decimal" placeholder="例：30" />
            <div class="help">FXの「限界利益率」を想定（わからなければ仮置き可）。</div>
          </div>
        </div>

        <div class="row" style="margin-top:10px;">
          <div>
            <label for="annualSales">年商（任意 / 円）</label>
            <input id="annualSales" inputmode="numeric" placeholder="例：120000000" />
            <div class="help">入れると「年商の何%か」が即出ます。</div>
          </div>
          <div>
            <label for="monthlySales">月商（任意 / 円）</label>
            <input id="monthlySales" inputmode="numeric" placeholder="例：10000000" />
            <div class="help">単価ルートの「必要値上げ率（%）」が計算できます。</div>
          </div>
        </div>

        <div class="kpi">
          <div class="k">
            <div class="t">必要売上（円 / 月）</div>
            <div class="v" id="needSalesM">—</div>
          </div>
          <div class="k">
            <div class="t">必要売上（円 / 年）</div>
            <div class="v" id="needSalesY">—</div>
          </div>
          <div class="k">
            <div class="t">年商に占める割合（% / 任意）</div>
            <div class="v" id="shareY">—</div>
          </div>
        </div>

        <div class="chips">
          <span class="chip">式：必要売上 ＝ 差額 ÷（限界利益率/100）</span>
          <span class="chip">ここが揃うと「単価/数量/自動化」の議論がブレません</span>
        </div>

        <div class="warnbox">
          <div style="font-weight:900; margin-bottom:6px;">商談での一言（型）</div>
          <div class="p" style="margin:0; color:var(--text);">
            「差額が高い/安いではなく、<b>この必要売上をどう作るか</b>を一緒に決めましょう。方法は3つしかありません。」
          </div>
        </div>
      </section>

      <!-- 1) 3ルート -->
      <section class="card" id="section-routes">
        <h2>回収ルートは3つだけ</h2>
        <div class="p">下の3つのどれで「必要売上」を作るかを決めます（= 商談のクロージングを“設計”に変える）。</div>

        <div class="routes">
          <button class="routeBtn" data-open="unit">
            <div class="name">単価を上げる</div>
            <div class="desc">必要売上を「必要値上げ率（%）」に落とす。</div>
            <div class="tag">最短で回収</div>
          </button>

          <button class="routeBtn" data-open="volume">
            <div class="name">数量を上げる</div>
            <div class="desc">必要売上を「必要追加販売数（件/個）」に落とす。</div>
            <div class="tag">営業が強い会社向け</div>
          </button>

          <button class="routeBtn" data-open="auto">
            <div class="name">経理プロセスを自動化する</div>
            <div class="desc">差額を「必要削減時間（h）」に落とす。</div>
            <div class="tag">確実に回収</div>
          </button>
        </div>

        <!-- 単価 -->
        <details id="panel-unit">
          <summary>単価を上げる（値上げで回収）</summary>
          <div class="row" style="margin-top:10px;">
            <div>
              <label for="avgPrice">平均単価（任意 / 円）</label>
              <input id="avgPrice" inputmode="numeric" placeholder="例：12000" />
              <div class="help">単価と数量があれば「1単位あたりの必要増額」も出ます。</div>
            </div>
            <div>
              <label for="unitsPerMonth">月間販売数量（任意 / 単位）</label>
              <input id="unitsPerMonth" inputmode="numeric" placeholder="例：300" />
              <div class="help">例：月300件、月300個、月300回など。</div>
            </div>
          </div>

          <div class="kpi">
            <div class="k">
              <div class="t">必要値上げ率（% / 月商入力時）</div>
              <div class="v" id="needPricePct">—</div>
            </div>
            <div class="k">
              <div class="t">1単位あたり必要増額（円 / 数量入力時）</div>
              <div class="v" id="needUpPerUnit">—</div>
            </div>
            <div class="k">
              <div class="t">商談コメント（例）</div>
              <div class="v mono" id="unitTalk">—</div>
            </div>
          </div>

          <div class="actions">
            <button class="btn primary" id="btnOpenPriceTool">価格改定ツールを開く</button>
            <button class="btn" id="btnOpenPortal">ツールポータル（母艦）を開く</button>
          </div>

          <div class="foot">
            ポイント：値上げ議論は抽象化しやすいので、<b>対象（商品/客層）・幅・実行日</b>をその場で決める。
          </div>
        </details>

        <!-- 数量 -->
        <details id="panel-volume">
          <summary>数量を上げる（件数・客数で回収）</summary>
          <div class="p">数量ルートは「あと何件」を必ず具体化。抽象論に逃げさせないためのパネルです。</div>

          <div class="kpi">
            <div class="k">
              <div class="t">必要追加販売数（単位 / 平均単価入力時）</div>
              <div class="v" id="needMoreUnits">—</div>
            </div>
            <div class="k">
              <div class="t">商談コメント（例）</div>
              <div class="v mono" id="volTalk">—</div>
            </div>
            <div class="k">
              <div class="t">軸を戻す（必要売上の再確認）</div>
              <div class="v" id="needSalesM2">—</div>
            </div>
          </div>

          <div class="actions">
            <button class="btn primary" id="btnOpenHendouPL">変動PLツールを開く</button>
          </div>

          <div class="foot">
            注意：数量ルートは、需要・稼働・オペの制約で詰まるケースが多い。詰まったら単価 or 自動化へ即スイッチ。
          </div>
        </details>

        <!-- 自動化 -->
        <details id="panel-auto">
          <summary>経理プロセスを自動化する（工数削減で回収）</summary>
          <div class="row" style="margin-top:10px;">
            <div>
              <label for="hourCost">時間単価（円 / 時）</label>
              <input id="hourCost" inputmode="numeric" placeholder="例：3000" />
              <div class="help">わからなければ、人件費見える化ツールで算出できます。</div>
            </div>
            <div>
              <label for="hoursSaved">想定削減時間（任意 / 月 h）</label>
              <input id="hoursSaved" inputmode="decimal" placeholder="例：10" />
              <div class="help">既に「削減できそうな時間」があるなら入力（比較用）。</div>
            </div>
          </div>

          <div class="kpi">
            <div class="k">
              <div class="t">回収に必要な削減時間（h / 月）</div>
              <div class="v" id="needHours">—</div>
            </div>
            <div class="k">
              <div class="t">不足/余裕（h / 月）</div>
              <div class="v" id="gapHours">—</div>
            </div>
            <div class="k">
              <div class="t">商談コメント（例）</div>
              <div class="v mono" id="autoTalk">—</div>
            </div>
          </div>

          <div class="actions">
            <button class="btn primary" id="btnOpenAutoTool">自動化効果ツールを開く</button>
            <button class="btn" id="btnOpenTimeUnit">人件費見える化（時間単価）を開く</button>
          </div>

          <div class="foot">
            ポイント：自動化は「削減時間→月次の前倒し→意思決定の速度」をセットで語ると、値引き交渉が止まります。
          </div>
        </details>
      </section>

      <!-- 2) 90日プラン（簡易） -->
      <section class="card" id="section-90">
        <h2>クロージングの着地点（90日設計）</h2>
        <div class="p">
          「売上が上がるなら契約」ではなく、<b>回収設計を90日で作れるか</b>で意思決定させます。
        </div>
        <div class="chips">
          <span class="chip">① 対象（商品/客層/業務）</span>
          <span class="chip">② 幅（%/円）または削減時間（h）</span>
          <span class="chip">③ 実行日</span>
          <span class="chip">④ 追う指標（単価/粗利/失注率/月次締め日）</span>
        </div>
        <div class="foot">
          ※このページは「商談の型」を固定するためのものです。必要に応じて、貴所の提案書テンプレへ転記してください。
        </div>
      </section>
    </div>
  </div>

<script>
  // ====== 設定：各ツールURL（必要に応じて差替え） ======
  const TOOL = {
    sales:  "https://takatrp.github.io/convert-to-sales/",
    price:  "https://takatrp.github.io/price-up-down/",
    pl:     "https://takatrp.github.io/hendou_PL/",
    auto:   "https://takatrp.github.io/jidouka-kouka/",
    time:   "https://takatrp.github.io/time-unit-cost/",
    portal: "https://takatrp.github.io/tool-portal/?start=1"
  };

  // ====== util ======
  const $ = (id)=>document.getElementById(id);

  function num(v){
    if(v==null) return 0;
    const s = String(v).trim().replace(/[,，\s]/g,'').replace(/[・]/g,'.');
    const n = Number(s);
    return Number.isFinite(n) ? n : 0;
  }
  function yen(n){
    if(!Number.isFinite(n)) return "—";
    const r = Math.round(n);
    return "¥" + r.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
  }
  function pct(n){
    if(!Number.isFinite(n)) return "—";
    return (Math.round(n*10)/10).toString() + "%";
  }
  function ceil1(n){
    if(!Number.isFinite(n)) return "—";
    const r = Math.ceil(n*10)/10;
    return r.toString();
  }

  // ====== state persistence ======
  const KEY="shodan_kit_v1";
  function load(){
    try{
      const raw = localStorage.getItem(KEY);
      return raw ? JSON.parse(raw) : {};
    }catch(e){ return {}; }
  }
  function save(obj){
    try{ localStorage.setItem(KEY, JSON.stringify(obj)); }catch(e){}
  }

  // URL params prefill: ?fee=20000&cmr=30&annual=120000000&monthly=10000000
  function prefillFromQuery(){
    const qs = new URLSearchParams(location.search);
    const v = {};
    if(qs.has("fee")) v.feeDiff = qs.get("fee");
    if(qs.has("cmr")) v.cmr = qs.get("cmr");
    if(qs.has("annual")) v.annualSales = qs.get("annual");
    if(qs.has("monthly")) v.monthlySales = qs.get("monthly");
    if(qs.has("price")) v.avgPrice = qs.get("price");
    if(qs.has("units")) v.unitsPerMonth = qs.get("units");
    if(qs.has("hour")) v.hourCost = qs.get("hour");
    if(qs.has("save") && qs.get("save")==="1") save(v);
    return v;
  }

  function applyValues(v){
    if(v.feeDiff!=null) $("feeDiff").value = v.feeDiff;
    if(v.cmr!=null) $("cmr").value = v.cmr;
    if(v.annualSales!=null) $("annualSales").value = v.annualSales;
    if(v.monthlySales!=null) $("monthlySales").value = v.monthlySales;
    if(v.avgPrice!=null) $("avgPrice").value = v.avgPrice;
    if(v.unitsPerMonth!=null) $("unitsPerMonth").value = v.unitsPerMonth;
    if(v.hourCost!=null) $("hourCost").value = v.hourCost;
    if(v.hoursSaved!=null) $("hoursSaved").value = v.hoursSaved;
  }

  function collect(){
    return {
      feeDiff: $("feeDiff").value,
      cmr: $("cmr").value,
      annualSales: $("annualSales").value,
      monthlySales: $("monthlySales").value,
      avgPrice: $("avgPrice").value,
      unitsPerMonth: $("unitsPerMonth").value,
      hourCost: $("hourCost").value,
      hoursSaved: $("hoursSaved").value
    };
  }

  // ====== calc ======
  function render(){
    const feeDiff = num($("feeDiff").value);
    const cmr = num($("cmr").value);
    const annualSales = num($("annualSales").value);
    const monthlySales = num($("monthlySales").value);

    const avgPrice = num($("avgPrice").value);
    const unitsPerMonth = num($("unitsPerMonth").value);

    const hourCost = num($("hourCost").value);
    const hoursSaved = num($("hoursSaved").value);

    // Base: sales equivalent
    const needSalesM = (cmr>0) ? feeDiff / (cmr/100) : NaN;
    const needSalesY = (Number.isFinite(needSalesM)) ? needSalesM * 12 : NaN;
    $("needSalesM").textContent = Number.isFinite(needSalesM) ? yen(needSalesM) : "—";
    $("needSalesY").textContent = Number.isFinite(needSalesY) ? yen(needSalesY) : "—";
    $("needSalesM2").textContent = Number.isFinite(needSalesM) ? yen(needSalesM) : "—";

    const share = (annualSales>0 && Number.isFinite(needSalesY)) ? (needSalesY/annualSales*100) : NaN;
    $("shareY").textContent = Number.isFinite(share) ? pct(share) : "—";

    // Unit route: required price increase %
    const needPricePct = (monthlySales>0 && Number.isFinite(needSalesM)) ? (needSalesM/monthlySales*100) : NaN;
    $("needPricePct").textContent = Number.isFinite(needPricePct) ? pct(needPricePct) : "—";

    const needUpPerUnit = (unitsPerMonth>0 && Number.isFinite(needSalesM)) ? (needSalesM/unitsPerMonth) : NaN;
    $("needUpPerUnit").textContent = Number.isFinite(needUpPerUnit) ? yen(needUpPerUnit) : "—";

    let unitTalk="—";
    if(Number.isFinite(needPricePct)){
      unitTalk = `月商に対して +${(Math.round(needPricePct*10)/10)}% の単価改善で回収できます`;
    }else if(Number.isFinite(needUpPerUnit)){
      unitTalk = `数量が変わらない前提なら、1単位あたり +${Math.round(needUpPerUnit)}円 で回収できます`;
    }
    $("unitTalk").textContent = unitTalk;

    // Volume route: required additional units
    const needMoreUnits = (avgPrice>0 && Number.isFinite(needSalesM)) ? (needSalesM/avgPrice) : NaN;
    $("needMoreUnits").textContent = Number.isFinite(needMoreUnits) ? (ceil1(needMoreUnits) + " 単位/月") : "—";

    let volTalk="—";
    if(Number.isFinite(needMoreUnits)){
      volTalk = `平均単価${Math.round(avgPrice)}円なら、追加で ${ceil1(needMoreUnits)}単位/月 が必要です`;
    }else{
      volTalk = `数量ルートにするなら「あと何件」を必ず具体化（平均単価を入力してください）`;
    }
    $("volTalk").textContent = volTalk;

    // Automation route: required hours saved
    const needHours = (hourCost>0) ? (feeDiff/hourCost) : NaN;
    $("needHours").textContent = Number.isFinite(needHours) ? (ceil1(needHours) + " h/月") : "—";

    let gap="—";
    if(Number.isFinite(needHours) && hoursSaved>0){
      const g = hoursSaved - needHours;
      gap = (g>=0)
        ? ("余裕 " + ceil1(g) + " h/月")
        : ("不足 " + ceil1(Math.abs(g)) + " h/月");
    }
    $("gapHours").textContent = gap;

    let autoTalk="—";
    if(Number.isFinite(needHours)){
      autoTalk = `時間単価${Math.round(hourCost)}円/hなら、${ceil1(needHours)}h/月の削減で差額回収です`;
    }
    $("autoTalk").textContent = autoTalk;

    // persist
    save(collect());
  }

  // ====== interactions ======
  function openUrl(url){
    window.open(url, "_blank", "noopener,noreferrer");
  }

  $("btnOpenSalesTool").addEventListener("click", ()=>openUrl(TOOL.sales));
  $("btnOpenPriceTool").addEventListener("click", ()=>openUrl(TOOL.price));
  $("btnOpenHendouPL").addEventListener("click", ()=>openUrl(TOOL.pl));
  $("btnOpenAutoTool").addEventListener("click", ()=>openUrl(TOOL.auto));
  $("btnOpenTimeUnit").addEventListener("click", ()=>openUrl(TOOL.time));
  $("btnOpenPortal").addEventListener("click", ()=>openUrl(TOOL.portal));

  // route buttons -> open details + scroll
  document.querySelectorAll(".routeBtn").forEach(btn=>{
    btn.addEventListener("click", ()=>{
      const key = btn.getAttribute("data-open");
      const map = {unit:"panel-unit", volume:"panel-volume", auto:"panel-auto"};
      const id = map[key];
      const el = $(id);
      el.open = true;
      el.scrollIntoView({behavior:"smooth", block:"start"});
    });
  });

  // Copy summary
  $("btnCopySummary").addEventListener("click", async ()=>{
    const feeDiff = num($("feeDiff").value);
    const cmr = num($("cmr").value);
    const annualSales = num($("annualSales").value);
    const monthlySales = num($("monthlySales").value);

    const needSalesM = (cmr>0) ? feeDiff / (cmr/100) : NaN;
    const needSalesY = (Number.isFinite(needSalesM)) ? needSalesM * 12 : NaN;
    const share = (annualSales>0 && Number.isFinite(needSalesY)) ? (needSalesY/annualSales*100) : NaN;
    const needPricePct = (monthlySales>0 && Number.isFinite(needSalesM)) ? (needSalesM/monthlySales*100) : NaN;

    const text =
`【商談キット（回収設計）】
・差額：${yen(feeDiff)}/月
・限界利益率：${cmr ? (cmr + "%") : "—"}
・必要売上：${Number.isFinite(needSalesM)?yen(needSalesM):"—"}/月（年 ${Number.isFinite(needSalesY)?yen(needSalesY):"—"}）
・年商比：${Number.isFinite(share)?pct(share):"—"}
・単価ルートの目安：${Number.isFinite(needPricePct)?("月商比 +" + (Math.round(needPricePct*10)/10) + "%"):"—"}

次の一手は「単価・数量・自動化」から1つに絞って90日で設計。
（ツール）売上換算:${TOOL.sales} / 価格改定:${TOOL.price} / 変動PL:${TOOL.pl} / 自動化:${TOOL.auto}`;
    try{
      await navigator.clipboard.writeText(text);
      const b = $("btnCopySummary");
      const old = b.textContent;
      b.textContent = "コピーしました";
      setTimeout(()=>b.textContent=old, 900);
    }catch(e){
      alert("コピーに失敗しました（端末の制約の可能性）。\n\n" + text);
    }
  });

  // inputs -> render
  ["feeDiff","cmr","annualSales","monthlySales","avgPrice","unitsPerMonth","hourCost","hoursSaved"]
    .forEach(id=>$(id).addEventListener("input", render));

  // init
  applyValues(load());
  applyValues(prefillFromQuery());
  render();
</script>
</body>
</html>
